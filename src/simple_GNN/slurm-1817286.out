  0%|          | 0/5301 [00:00<?, ?it/s]../utils/dataset.py:68: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  user["label"][i] = id_to_label[user["id"][i]]
../utils/dataset.py:69: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  user["split"][i] = id_to_split[user["id"][i]]
  1%|          | 65/5301 [00:00<00:08, 624.43it/s] 17%|█▋        | 879/5301 [00:00<00:00, 4971.97it/s] 32%|███▏      | 1697/5301 [00:00<00:00, 6422.32it/s] 47%|████▋     | 2503/5301 [00:00<00:00, 7064.46it/s] 63%|██████▎   | 3324/5301 [00:00<00:00, 7473.69it/s] 78%|███████▊  | 4146/5301 [00:00<00:00, 7725.26it/s] 94%|█████████▎| 4969/5301 [00:00<00:00, 7887.50it/s]100%|██████████| 5301/5301 [00:00<00:00, 7115.92it/s]
  0%|          | 0/29 [00:00<?, ?it/s]Epoch:0:   0%|          | 0/29 [00:00<?, ?it/s]Epoch:0:   0%|          | 0/29 [00:00<?, ?it/s, loss=1.03]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=1.03]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=1.03]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=1.01]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=1.01]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=1.04]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=1.04]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=1.01]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=1.01]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=1]   Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=1]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.999]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.999]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=1.01] Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=1.01]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=1.01]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=1.01]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.973]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.973]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.962]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.962]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.782]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.782]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.477]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.477]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.495]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.495]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.473]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.473]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.462]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.462]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.471]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.471]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.482]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.482]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.467]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.467]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.625]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.625]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.649]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.649]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.632]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.632]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.625]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.625]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.572]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.572]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.475]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.475]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.477]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.477]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.475]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.475]Epoch:0:   3%|▎         | 1/29 [00:00<00:06,  4.60it/s, loss=0.476]Epoch:0:  93%|█████████▎| 27/29 [00:00<00:00, 105.77it/s, loss=0.476]Epoch:0:  93%|█████████▎| 27/29 [00:00<00:00, 105.77it/s, loss=0.476]Epoch:0:  93%|█████████▎| 27/29 [00:00<00:00, 105.77it/s, loss=0.466]Epoch:0:  93%|█████████▎| 27/29 [00:00<00:00, 105.77it/s, loss=0.466]Epoch:0:  93%|█████████▎| 27/29 [00:00<00:00, 105.77it/s, loss=0.49] Epoch:0: 100%|██████████| 29/29 [00:00<00:00, 89.47it/s, loss=0.49] 
/scratch/network/rr4001/projects/voon/envs/botbusters/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
(1058,)
[0 0 0 ... 0 0 0]
Traceback (most recent call last):
  File "train.py", line 246, in <module>
    trainer.train()
  File "train.py", line 157, in train
    val_results = self.valid()
  File "/scratch/network/rr4001/projects/voon/envs/botbusters/lib/python3.7/site-packages/torch/autograd/grad_mode.py", line 28, in decorate_context
    return func(*args, **kwargs)
  File "train.py", line 106, in valid
    val_loss = self.loss_func(torch.tensor(preds).reshape(-1, 1), data.y)
  File "/scratch/network/rr4001/projects/voon/envs/botbusters/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/scratch/network/rr4001/projects/voon/envs/botbusters/lib/python3.7/site-packages/torch/nn/modules/loss.py", line 1121, in forward
    ignore_index=self.ignore_index, reduction=self.reduction)
  File "/scratch/network/rr4001/projects/voon/envs/botbusters/lib/python3.7/site-packages/torch/nn/functional.py", line 2824, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index)
RuntimeError: "log_softmax_lastdim_kernel_impl" not implemented for 'Long'
